you're managing multiple Python apps in one project one repository that can be quite messy you'll have multiple virtual environments log files different versions of dependencies and so on but with UV workspaces you can actually manage multiple apps with shared code shared dependencies pretty cleanly so today I'll show you how that works and I'm going to do that by building a CLI tool a fast API app that both fetch headlines from hacker news and summarize them using an LLM and I'll set it all up using UV workspaces to keep everything fast and dry which by the way it's not at all in the Netherlands at the moment it's raining quite a lot so at least my coat is going to be dry that's something that I have to hang on to now here's the example that I'm going to work with today i have this command line interface you see there is a bit of a mess here with the imports uh I'll clean that up in a minute but actually the code here is uh pretty basic i'm using some uh libraries like hpx and beautiful soup to get some news from uh hacker news so there's a function here that fetches headlines from that site and then it parses the text using beautiful soup and it tries to get some titles from it then what it does is it creates a command line interface using typer which by the way is also an awesome package and I define a command headlines that gets these headlines and then simply prints them nicely using rich which is another nice package lots of nice packages here now the setup for this code is also pretty simple i have a pi project file that just has a couple of dependencies i can install these dependencies like so and then I can run my main file now there's no requires Python there's a reason for that i'll talk about that in a minute but basically not get some headlines from hacker news like mpm malware yeah don't use that well if you're doing web development you probably have no choice uh hosting website and so on and so on so this seems to work as expected now the problem comes when you're not just dealing with one package but if you're trying to add more things to this let's say you also want to build an API that actually retrieves this for you and since this is so closely related to the CLI you're going to want to put it in the same repository so then you would create another folder which would have your fast API app and magically I have actually already done that so as you can see I have an API folder here which has a main file uh that's a fast API app uses uicorn to run the server and it has a headlines endpoint which well fetches the headlines and then returns that as JSON data now the problem here is that we had to copy a lot of code uh this fetch headlines function had to copy that over uh I had to also copy the dependencies because now this API also needs beautiful soup and httpx and that's obviously not ideal now you could try to turn this into a package and publish it on pipi or something and then use it here but that's also kind of annoying you want to be able to just do that locally right uh you could uh create like one big Python package and then have uh undumber in it files everywhere which is maybe also not ideal and this is a place where the UV workspace comes in very handy the first thing you can do with this is that you can define shared dependencies in a root pi project tol file and then these dependencies are installed once in a single virtual environment and that is then used by all the sub projects and that also avoids a lot of version conflicts and duplication so let's say I want to take uh some of these imports that I have here and I want to move them to a workspace level pi project file so the overall structure of the folder and you see I already did some previous work here is that you can now have a pi project tol file here where you can then add those dependencies so this is in principle the root of our workspace and I can add these dependencies here for example if I go to my API I have a fast API and a UIORN for example i can put those in my root PI project file there we go and now these dependencies are here and now in my API folder I can remove these the only thing I need to do is indicate to UV that this is actually a workspace and in order to do that I need to modify my root by project file and what I'm going to do is I'm going to add a tool uvworkspace and the members are any folder in the packages folder so that's in this case both the API and the CLI and now what's going to happen is that you saw that before it created a virtual environment inside the CLI folder because it just work directly from there but what we can do now is create a virtual environment at the top level so I'll just remove this folder and then what I'm going to do going to move up to the top level and now I'm going to do UV sync all packages and now it's going to create a virtual environment for all the packages in my project and as you can see there's now a VM folder that appears at the top level and what I can do now is I can do UV from packages CLI non.pi pi and now it's going to run my command line interface but using the top level virtual environment and dependencies similarly I can now also start the API and let me just start a new terminal here and now I'm just going to do a call request to this URL slash headlines and now you can't really see this clearly let me move this to the top bar now you can see we have our JSON data as a response from this API and also as you can see there's no virtual environment folder here it uses the virtual environment at the top level so that's really nice and this already very helpful like uh I have a N here for example which is being used by the API to define things like the host and the port well actually I now also have access to M from my uh command line interface which is really cool and actually uh in order to solve all these type issues I can now select this top level workspace and now I also get correct type annotations in VS code which is really nice so it's really cool that we now have this place where we can put shared dependencies and that solves a lot of potential version conflicts between the code in these different packages by the way making the right architectural decisions at the start of your project is really important it's easy to make costly mistakes if you don't know what you need to consider so I created a free architecture checklist to help you get organized go to our code/checklist to grab your copy this contains a ton of practical advice and a list of important things to think about you can takeick off so you don't forget anything iron.code/checklist link is also in description of this video now there is still one thing we need to fix duplicate code in our project we have fetch headlines in the CLI and we also have a fetch headlines in the API so what I'm going to do now is create an internal package where I can store this duplicate code and then import it in the various places where I need it and also that I'm going to do under the packages folder so what I'm going to do is create a folder called core and that's going to be the name of my package not a really great name but well we'll just have to do and then inside that I'm going to structure this more like a true package so I'm going to have a source folder inside that I'm going to have the core folder and inside that I'm going to have news.I and I'm going to take this function fetch headlines and these dependencies as well i'm going to put that right here and of course I'm also going to need a by project file and and inside that we're going to have something like this so there's the hpx and beautiful soup dependencies that this particular library needs and now we have our package here and now what I'd like to do is I'd like to go in here and then I'd like to import this from the core package so I'd like to type something like this from core top.news import fetch headlines and as you can see this doesn't work yet but I'll come to that in a minute so that's the idea right and then we also don't need this and we don't need this either so how can we make sure that core news is now recognized well obviously what we need to do is we need to add core as a dependency but it's not a package that we can install from Pippi or something what we're going to do instead and we can do it here inside the CLI pi project file or we can do it in the global pi project file the workspace level and that's where I'm going to do it and I'm going to add core as a dependency now of course if you do it like this and just try this then it's going to try to install this from Pippi which is not what we want but what you can actually do in a workspace is that you can indicate that some of these dependencies are actually local and they are inside the workspace oh that's uh great okay apparently Toml doesn't really like my style of typing anyway uv sources is what we then need to add to our pip project file and what I'm going to do here is I'm going to say that well core is and uh as you can see AI is making up a bunch of stuff which is not great but actually what we want to do is workspace is true so now UV knows that oh core is actually something that I don't need to get from pipi something it's like a local thing let's sync this all up again as you can see it actually took the core package from a file so that seems to work and now what we can do is I can run my CLI again and now it uses the fetch headlines function from our internal core package which is really neat and of course now that we have it here it's also really easy to add it to the API so in case of the API what I'll do is I'll just delete this because we don't need that here we don't need beautiful sbx and in fact we're going to import the fetch headlines function from core news now unfortunately as you can see uh the VS Code import system doesn't recognize this uh workspace thing yet at least it doesn't do it correctly in my setup maybe I need to do some changes here and there but when I run this this should work without any issue so I'm starting the server again and now I'm going to do my cur request one more time and then it uses the API and then it accesses the API which in turn uses our fetch headlines function from the core package which is really neat and now you know once we have this set up we can also start thinking a bit about okay where do we put certain dependencies for example in the API I currently don't have any dependencies these are at the top level but you know it might be helpful to actually have these two fast API and uicorn in my API dependencies and not in the global dependencies because they're not being used in any other packages right so I'll remove them here and then I can go back into my API project file and I can add them here like so and let's see we have our CLI so this has typer rich HTTP and beautiful soup it doesn't need these two anymore because these will be part of our uh core package as you can see they're right here so now we have these dependencies that are specific to each package core has hpx beautiful soup our CLI has typer enrich uh the API has fast API u and our top level pi project file has python.n and the core internal package also as you can see at the top level I've defined the Python version that is required this case that's 3.13 or higher i mean you could use an older version of Python but at least this way for all the projects this value is going to be defined which is a really neat way to do it in my opinion now just to complete this example let's add one more package to this that actually uses an LM to summarize text so I'm going to create a new package here called summarizer and I'll set it up similarly to the core package so there's a source folder inside that it has summarizer and then we have a file summarize pi and inside this I've already prepared this like a Swedish chef i've created a very simple function called summarize text that gets text that gets an API key creates an open AI client and then it sends a request to GPT5 and returns the output text of course we can make this as complicated as you want just a basic example of course in this new library I'm also going to need a pi project file and this is what the contents of that file looks like and has a single dependency open AI so now once we have this the nice thing is that because in the top level tone file I've defined that our members is every subfolder in the package folder now actually our summarizer package is also available and I can add it as a dependency like so and then of course I also have to add it here to my sources so I can use it in the code and now when I go back to my CLI for example I can import from summarizer dots summarize import summarize text like so it's maybe not an ideal name for a library it's a bit long to type but doesn't matter but now we can call this function and the only thing we're going to need is a open AAI API key which I have in this file so what I do here is from uh end I'm going to import log.enf I'm going to call that so I have the API key available as an environment variable and then I'm going to import OS and then the API key is open AI API key and then what I'm going to do is uh call summary on summarize text on the headlines and I pass the API key as well and then I'm simply going to print that summary so now let's run this that's going to build the summarizer package which of course it's going to need and then we have the top five headlines now it's sending it to OpenAIL LM and then I have a summary of that so that's really easy really easy to add more uh functionality to this and now I have a pretty neat setup where you know I can add more uh packages here more tools uh I can decide where I want to store these dependencies do I want at the top level do we want them locally in a package it's very flexible and it's really easy to use and of course now if I wanted to summarize a package I could also use that in the API or if I would add a third type of tool here I could then also use the other modules there as well so overall it's a really nice setup that would be a lot messier and errorprone if you had to use many uh local dependencies and many virtual environments here it's just one virtual environment so when should you use this one in our case we're using this for our automation so we have this repository which has all sorts of small automations basically Python scripts that uh respond to some uh web hook or that uh extract some data from some API and then send it to another API and these all have mostly overlapping dependencies they're all using HTTPX and fast API and a couple of other things as well and uh there's also some uh common uh dependencies between them for example I've created a small layer on top of our accounting system that all of these uh projects are actually using so this uh workspace setup allows me to do that in a really clean fashion so if that's something that you're dealing with uh then this is a really good solution for you if you have global dependencies that you need to share uh if you want a one log file uh for reproducibility uh then this is all a very good choice it's probably not worth it if you just have a single script or app or you know you have a package that you want to release to Pippi independently this maybe not the way to set it up or uh if you have a repo with like completely unrelated apps then this is also not a really good choice in that case I would actually suggest you split your repo into multiple repos one per package anyway I hope this video gave you a better view of what UV workspaces are and what you can do with them if you like this kind of in-depth look into modern Python tooling hit the like button subscribe to my channel this really helps me make more videos like this overall though I really like this feature of UV makes it super easy to manage multiple Python apps in one repo and it's a very clean solution that avoids code repetition but I'd love to hear from you how do you manage your multi-app Python projects are you using UV workspaces for that let me know in the comments if you'd like to learn more about UV and what other things you can do with it make sure to watch this video next thanks for watching and see you next